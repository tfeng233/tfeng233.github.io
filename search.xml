<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>Hadoop集群-Ambari</title>
      <link href="/2021/09/16/hadoop-ji-qun-ambari/"/>
      <url>/2021/09/16/hadoop-ji-qun-ambari/</url>
      
        <content type="html"><![CDATA[<h1 id="目录"><a href="#目录" class="headerlink" title="目录"></a>目录</h1><p><a href="#ambari%E7%9A%84%E4%BB%8B%E7%BB%8D"><strong>Ambari的介绍 3</strong></a></p><p><a href="#11-%E4%BB%80%E4%B9%88%E6%98%AFambari">1.1 什么是Ambari 3</a></p><p><a href="#_Toc28206">1.3 Ambari 架构原理 3</a></p><p><a href="#%E9%A1%B9%E7%9B%AE%E6%84%8F%E4%B9%89"><strong>项目意义 4</strong></a></p><p><a href="#%E9%A1%B9%E7%9B%AE%E6%B5%81%E7%A8%8B%E5%9B%BE"><strong>项目流程图 4</strong></a></p><p><a href="#_Toc20347"><strong>集群环境 5</strong></a></p><p><a href="#%E9%A1%B9%E7%9B%AE%E5%AE%9E%E7%8E%B0"><strong>项目实现 5</strong></a></p><p><a href="#_Toc18628">一、安装虚拟机 5</a></p><p><a href="#_Toc7132">(一) 安装一台Centos7虚拟机作为Master节点 5</a></p><p><a href="#_Toc9564">(二) 修改配置Master主机 14</a></p><p><a href="#_Toc31031">①设置IP地址 14</a></p><p><a href="#_Toc640">②修改主机名 15</a></p><p><a href="#_Toc5704">③修改hosts文件 15</a></p><p><a href="#_Toc20857">④关闭Master主机防火墙、禁用selinux、安装必备软件 15</a></p><p><a href="#_Toc27646">⑤配置JDK8 15</a></p><p><a href="#_Toc26904">(三)克隆虚拟机 15</a></p><p><a href="#%E9%85%8D%E7%BD%AEssh%E5%85%8D%E5%AF%86">二、 配置SSH免密 17</a></p><p><a href="#_Toc11300">三、 安装与设置MySQL 17</a></p><p><a href="#_Toc16605">(一) 安装MySQL 17</a></p><p><a href="#_Toc13334">(二) 配置Mysql 17</a></p><p><a href="#_Toc4717">四、 安装Ambari 19</a></p><p><a href="#%E5%AE%89%E8%A3%85httpd%E5%BC%80%E5%90%AF%E8%B6%85%E6%96%87%E6%9C%AC%E4%BC%A0%E8%BE%93%E6%9C%8D%E5%8A%A1%E4%B8%BAambari%E6%8F%90%E4%BE%9B%E6%9C%AC%E5%9C%B0yum%E6%BA%90">(一) 安装httpd，开启超文本传输服务，为Ambari提供本地yum源<br>19</a></p><p><a href="#%E9%85%8D%E7%BD%AEyum%E6%BA%90%E6%9C%8D%E5%8A%A1">(二) 配置yum源服务 19</a></p><p><a href="#_Toc4965">①上传ambari、HDP、HDP-UTILS 19</a></p><p><a href="#_Toc23781">②解压ambari、HDP、HDP-UTILS 19</a></p><p><a href="#_Toc122">③配置系统yum源 19</a></p><p><a href="#_Toc2604">④生成离线源 20</a></p><p><a href="#_Toc29110">⑤刷新yum源 20</a></p><p><a href="#%E5%AE%89%E8%A3%85%E4%B8%8E%E9%85%8D%E7%BD%AEambari-server">(三) 安装与配置Ambari-Server 20</a></p><p><a href="#_Toc4831">①安装ambari-server 20</a></p><p><a href="#_Toc13965">②配置JDBC驱动包 20</a></p><p><a href="#_Toc13859">③配置ambari信息 21</a></p><p><a href="#_Toc16560">④初始化Ambari数据库 22</a></p><p><a href="#%E5%90%AF%E5%8A%A8ambaer-server">(四) 启动ambaer-server 23</a></p><p><a href="#_Toc10259">(五) 创建ambari-agent集群 23</a></p><h1 id="Ambari的介绍"><a href="#Ambari的介绍" class="headerlink" title="Ambari的介绍"></a>Ambari的介绍</h1><h2 id="1-1-什么是Ambari"><a href="#1-1-什么是Ambari" class="headerlink" title="1.1 什么是Ambari"></a>1.1 什么是Ambari</h2><p>跟 Hadoop 等开源软件一样，也是 Apache<br>软件基金会的一个顶级项目。目前为止最新的发布版本是 2.7.5。就Ambari<br>的作用来说，就是创建、管理、监视 Hadoop 的集群，但是这里的 Hadoop 是广义，指的是<br>Hadoop 整个生态圈(例如 Hive，Hbase，Sqoop，Zookeeper 等)，而并不仅是特指<br>Hadoop。使用Apache的开源产品Ambari<br>Web工具快速完成基于HDP的大数据平台的搭建、维护、监控。  </p><p><strong>1.2 Ambari的功能</strong><br>提供了跨任意数量的主机安装Hadoop服务的分步向导。<br>处理群集的Hadoop服务配置。<br>提供集中管理，用于在整个集群中启动，停止和重新配置Hadoop服务。<br>提供了一个仪表板，用于监控Hadoop集群的运行状况和状态。<br>利用Ambari指标系统进行指标收集。<br>利用Ambari Alert<br>Framework进行系统警报，并在需要您注意时通知您（例如，节点出现故障，剩余磁盘空间不足等）。</p><p><strong>1.3 Ambari 架构原理</strong><br>Ambari框架采用的是Server/Client的模式，主要由两部分组成：ambari-agent和ambari-server。</p><p>Ambari-server主要管理部署在每个节点上的管理监控程序。<br>Ambari-agent 部署在监控节点上运行的管理监控程序。<br>Ambari-web 作为用户与 Ambari server 交互的。</p><p><img src="http://qypk54f5a.hn-bkt.clouddn.com/1e3afb52129241abfcf18c4d8a5589cb.jpg"></p><p>Ambari 提供 Ambari web，rest api，Ambari shell 三大方式操作集群；<br>Ambari 将集群的配置、各个服务的配置等信息存在 Ambari server 端的 DB<br>中(比如可以是Mysql)；<br>Ambari server 与 Ambari agent 的交流走 RPC，即 agent 向 server 报告心跳，server<br>将 command 通过 response 发回给 agent，agent 本地执行命令；<br>Ambari 有自己的一套监控、告警、镜像服务，以可插拔的形式供上层服务调用；</p><h1 id="项目意义"><a href="#项目意义" class="headerlink" title="项目意义"></a>项目意义</h1><p>使用Apache下的开源Ambari对ZooKeeper分布式生态系统、Hive仓库工具、HBase分布式数据库、Sqoop数据转移工具、Flume、Spark等大数据平台技术进行统一搭建、管理和监控功能。提供对大数据平台以指引式方式安装、配置；提供集群主要大数据服务启动、停止功能；同时还提供所有组件及服务的健康运行状态和预警功能，从而达到对大数据平台的简易、高效、安全的进行管理和维护。</p><h1 id="项目流程图"><a href="#项目流程图" class="headerlink" title="项目流程图"></a>项目流程图</h1><p><img src="http://qypk54f5a.hn-bkt.clouddn.com/5d045b4ab8144a4d8ff91e83ffec9646.jpg"></p><h1 id="集群环境"><a href="#集群环境" class="headerlink" title="集群环境"></a>集群环境</h1><p>操作系统：Centos7</p><p>Java编译环境：JDK1.8</p><p>Python解释环境：Python2.7</p><p>集群规划</p><table><thead><tr><th><strong>主机名</strong></th><th><strong>IP</strong></th><th><strong>主要服务</strong></th></tr></thead><tbody><tr><td>master</td><td>192.168.88.200</td><td>Ambari-Server</td></tr><tr><td>slave1</td><td>192.168.88.201</td><td>Ambari-Agent</td></tr><tr><td>slave2</td><td>192.168.88.202</td><td>Ambari-Agent</td></tr></tbody></table><h1 id="项目实现"><a href="#项目实现" class="headerlink" title="项目实现"></a>项目实现</h1><h2 id="一、安装虚拟机"><a href="#一、安装虚拟机" class="headerlink" title="一、安装虚拟机"></a>一、安装虚拟机</h2><h3 id="一-安装一台Centos7虚拟机作为Master节点"><a href="#一-安装一台Centos7虚拟机作为Master节点" class="headerlink" title="(一)安装一台Centos7虚拟机作为Master节点"></a>(一)安装一台Centos7虚拟机作为Master节点</h3><p>点击文件-&gt;新建虚拟机</p><p><img src="http://qypk54f5a.hn-bkt.clouddn.com/21341e4a15e3fa02cc6e3895360a79fa.jpg"></p><p>选择自定义（高级），然后点击下一步</p><p><img src="http://qypk54f5a.hn-bkt.clouddn.com/ffe686873e41ec7218274d560257639b.jpg"></p><p>选择Centos7镜像文件所在位置，点击下一步</p><p><img src="http://qypk54f5a.hn-bkt.clouddn.com/1b0c79a162daacf2f80de58db088ade3.jpg"></p><p>编辑虚拟机名称为master，设置虚拟机存储路径</p><p><img src="http://qypk54f5a.hn-bkt.clouddn.com/2900f63d6c15963d0b15dfcae5602d18.jpg"></p><p>默认，点击下一步</p><p><img src="http://qypk54f5a.hn-bkt.clouddn.com/dc1a5b3de72f7f373f237f8e559daabc.jpg"></p><p>设置虚拟机内存为2048，点击下一步</p><p><img src="http://qypk54f5a.hn-bkt.clouddn.com/085931b31c9195f0609a7a8866da29bb.jpg"></p><p>选择使用网络地址转发NAT</p><p><img src="http://qypk54f5a.hn-bkt.clouddn.com/6b952fa4500f60b7bf497a33dde0ec13.jpg"></p><p><img src="http://qypk54f5a.hn-bkt.clouddn.com/c3eaf16f2f1726565fb18b427b4c56d6.jpg"></p><p><img src="http://qypk54f5a.hn-bkt.clouddn.com/25a50a9afd9cd6b786b3112a58d884e3.jpg"></p><p><img src="http://qypk54f5a.hn-bkt.clouddn.com/1d88287f9ad42cd13946dfa80e9cc0b0.jpg"></p><p>设置最大磁盘大小为50，并选择存储为单个文件（如果选择拆分为多个文件，虚拟机无法扩容），然后点击下一步</p><p><img src="http://qypk54f5a.hn-bkt.clouddn.com/110c80fa226d05d0d38aa8e65da01784.jpg"></p><p>默认，下一步</p><p><img src="http://qypk54f5a.hn-bkt.clouddn.com/a925f73211ba956781b061f30f730fd5.jpg"></p><p><img src="http://qypk54f5a.hn-bkt.clouddn.com/f86c1d874cf9166b0031e90df8f63269.jpg"></p><p>开启虚拟机，选择English，点击continue</p><p><img src="http://qypk54f5a.hn-bkt.clouddn.com/fd275b9904029c711fee4788ed6ae9e8.jpg"></p><p><img src="http://qypk54f5a.hn-bkt.clouddn.com/dbb3c59aff0340cbd036ded4abcf33a6.jpg"></p><p><img src="http://qypk54f5a.hn-bkt.clouddn.com/d93349f9a6e22b444e4f9a1852725219.jpg"></p><p><img src="http://qypk54f5a.hn-bkt.clouddn.com/c50266e94588f1a715cebca7021020d6.jpg"></p><p><img src="http://qypk54f5a.hn-bkt.clouddn.com/af133e46a9422bcc06fbedb59f2e4f1a.jpg"></p><p>设置Root用户登录密码，然后点击Done</p><p><img src="http://qypk54f5a.hn-bkt.clouddn.com/083fbefe63a80ea0876579e27b7d6471.jpg"></p><p>安装完成后选择Reboot，重启虚拟机</p><p><img src="http://qypk54f5a.hn-bkt.clouddn.com/4d1a9df1a97f677261daae88442832f0.jpg"></p><h3 id="二-修改配置Master主机"><a href="#二-修改配置Master主机" class="headerlink" title="(二)修改配置Master主机"></a>(二)修改配置Master主机</h3><p><strong>①设置IP地址</strong></p><pre class="line-numbers language-linux" data-language="linux"><code class="language-linux">vi /etc/sysconfig/network-scripts/ifcfg-ens33<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>修改BOOTPROTO=static，ONBOOT=yes，添加红色方框中的内容</p><p><img src="http://qypk54f5a.hn-bkt.clouddn.com/a85da4a1d56383c097c858bc805df17e.jpg"></p><p>重启网卡 </p><pre class="line-numbers language-linux" data-language="linux"><code class="language-linux">systemctl restart network<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><strong>②修改主机名</strong></p><pre class="line-numbers language-none"><code class="language-none">hostnamectl set-hostname master<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><strong>③修改hosts文件</strong></p><pre class="line-numbers language-sh" data-language="sh"><code class="language-sh">vi /etc/hosts127.0.0.1 localhost localhost.localdomain localhost4 localhost4.localdomain4::1 localhost localhost.localdomain localhost6 localhost6.localdomain6192.168.88.200 master192.168.88.201 slave1192.168.88.202 slave2<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>④关闭Master主机防火墙、禁用selinux、安装必备软件</strong></p><pre class="line-numbers language-linux" data-language="linux"><code class="language-linux">systemctl disable firewalldRemoved symlink /etc/systemd/system/multi-user.target.wants/firewalld.service.Removed symlink /etc/systemd/system/dbus-org.fedoraproject.FirewallD1.service.<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-linux" data-language="linux"><code class="language-linux">systemctl stop firewalld<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-none"><code class="language-none">vi /etc/selinux/config<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>修改SELINUX=disabled</p><pre class="line-numbers language-none"><code class="language-none">yum -y install vim net-tools autoconf createrepo<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><strong>⑤配置JDK8</strong></p><p>解压jdk压缩包</p><pre class="line-numbers language-none"><code class="language-none">tar -zxvf jdk-8u221-linux-x64.tar.gz -C /usr/local/<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>配置jdk环境变量</p><pre class="line-numbers language-none"><code class="language-none">vi /etc/profile<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>添加内容</p><pre class="line-numbers language-sh" data-language="sh"><code class="language-sh">export JAVA_HOME=/usr/local/jdk1.8.0_221export PATH=\$PATH:\$JAVA_HOME/bin<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>刷新环境变量</p><pre class="line-numbers language-linux" data-language="linux"><code class="language-linux">source /etc/profile<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>验证jdk是否配置成功</p><pre class="line-numbers language-linux" data-language="linux"><code class="language-linux">java -version<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>​    java version “1.8.0_221”</p><p>​    Java(TM) SE Runtime Environment (build 1.8.0_221-b11)</p><p>​    Java HotSpot(TM) 64-Bit Server VM (build 25.221-b11, mixed mode)</p><h3 id="三-克隆虚拟机"><a href="#三-克隆虚拟机" class="headerlink" title="(三)克隆虚拟机"></a>(三)克隆虚拟机</h3><p>关闭虚拟机电源</p><p><img src="http://qypk54f5a.hn-bkt.clouddn.com/26c3d414a2a165b5fc03d5e99fea6e7b.jpg"></p><p><img src="http://qypk54f5a.hn-bkt.clouddn.com/ebf7155b7fc75b64542cb806c4bf545c.jpg"></p><p>选择完全克隆，点击下一步</p><p><img src="http://qypk54f5a.hn-bkt.clouddn.com/6fb3d87515253baf556e6b55979aea4a.jpg"></p><p>虚拟机名称为slave1，</p><p><img src="http://qypk54f5a.hn-bkt.clouddn.com/31f87e1736f6d5b8e316054ab22a5803.jpg"></p><p>再用同样的方法克隆出slave2主机，并修改slave1、slave2的IP地址和主机名</p><h2 id="配置SSH免密"><a href="#配置SSH免密" class="headerlink" title="配置SSH免密"></a>配置SSH免密</h2><pre class="line-numbers language-none"><code class="language-none">ssh-keygen;ssh-copy-id master;ssh-copy-id slave1;ssh-copy-id<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>slave2</p><h2 id="安装与设置MySQL"><a href="#安装与设置MySQL" class="headerlink" title="安装与设置MySQL"></a>安装与设置MySQL</h2><h3 id="安装MySQL"><a href="#安装MySQL" class="headerlink" title="安装MySQL"></a>安装MySQL</h3><p>卸载mariadb</p><pre class="line-numbers language-none"><code class="language-none">rpm -qa \| grep mar<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>libsmartcols-2.23.2-61.el7.x86_64</p><p>mariadb-libs-5.5.64-1.el7.x86_64</p><pre class="line-numbers language-none"><code class="language-none">rpm -e mariadb-libs-5.5.64-1.el7.x86_64 --nodeps<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>上传mysql压缩包到Linux中</p><p>解压mysql压缩包</p><pre class="line-numbers language-none"><code class="language-none">tar -xvf MySQL-5.6.47-1.el7.x86_64.rpm-bundle.tar<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>创建MySQL用户和组</p><pre class="line-numbers language-none"><code class="language-none">groupadd -g 1000 mysqluseradd mysql -g mysql -p mysql<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>安装MySQL-Server</p><pre class="line-numbers language-none"><code class="language-none">rpm -ivh MySQL-server-5.6.47-1.el7.x86_64.rpm<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>安装MySQL-Client</p><pre class="line-numbers language-none"><code class="language-none">rpm -ivh MySQL-client-5.6.47-1.el7.x86_64.rpm<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>安装MySQL-Devel</p><pre class="line-numbers language-none"><code class="language-none">rpm -ivh MySQL-devel-5.6.47-1.el7.x86_64.rpm<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>安装MySQL-Shared</p><pre class="line-numbers language-none"><code class="language-none">rpm -ivh MySQL-shared-5.6.47-1.el7.x86_64.rpm<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="配置Mysql"><a href="#配置Mysql" class="headerlink" title="配置Mysql"></a>配置Mysql</h3><p>复制配置文件，修改配置文件</p><pre class="line-numbers language-sh" data-language="sh"><code class="language-sh">cp /usr/share/mysql/my-default.cnf /etc/my.cnfvim /etc/my.cnf#新增内容[client]default-character-set=utf8[mysqld]character-set-server=utf8collation-server=utf8_general_ci<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>设置MySQL为自启并启动MySQL</p><pre class="line-numbers language-none"><code class="language-none">chkconfig mysql onservice mysql start<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>​        Starting MySQL….. SUCCESS!</p><p>查看MySQL初始密码并登录</p><pre class="line-numbers language-linux" data-language="linux"><code class="language-linux">cat /root/.mysql_secret \| grep password<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p># The random password set for the root user at Wed Aug 25 23:31:52 2021 (local<br>time): 63o8MBU7jF2CZY9K</p><pre class="line-numbers language-none"><code class="language-none">mysql -uroot -p<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>设置MySQL-root用户的密码</p><pre class="line-numbers language-mysql" data-language="mysql"><code class="language-mysql">mysql&gt; set password=password('123456');Query OK, 0 rows affected (0.00 sec)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>创建Ambari数据库</p><pre class="line-numbers language-mysql" data-language="mysql"><code class="language-mysql">mysql&gt; create database ambari;Query OK, 1 row affected (0.00 sec)mysql&gt; show databases;+--------------------+|Database|+--------------------+|information_schema||ambari||mysql||performance_schema||test|+--------------------+<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>5 rows in set (0.14 sec)</p><p>创建Ambari用户，并设置权限</p><pre class="line-numbers language-mysql" data-language="mysql"><code class="language-mysql">mysql&gt; create user 'ambari'@'localhost' identified by 'ambari';Query OK, 0 rows affected (0.00 sec)mysql&gt; grant all on ambari.* to ambari@localhost identified by 'ambari';Query OK, 0 rows affected (0.00 sec)mysql&gt; create user 'ambari'@'master' identified by 'ambari';Query OK, 0 rows affected (0.13 sec)mysql&gt; grant all on ambari.* to ambari@master identified by 'ambari';Query OK, 0 rows affected (0.00 sec)mysql&gt; create user 'ambari'@'%' identified by 'ambari';Query OK, 0 rows affected (0.00 sec)mysql&gt; grant all on ambari.* to 'ambari'@'%' identified by 'ambari';Query OK, 0 rows affected (0.00 sec)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="安装Ambari"><a href="#安装Ambari" class="headerlink" title="安装Ambari"></a>安装Ambari</h2><h3 id="安装httpd，开启超文本传输服务，为Ambari提供本地yum源"><a href="#安装httpd，开启超文本传输服务，为Ambari提供本地yum源" class="headerlink" title="安装httpd，开启超文本传输服务，为Ambari提供本地yum源"></a>安装httpd，开启超文本传输服务，为Ambari提供本地yum源</h3><pre class="line-numbers language-Linux" data-language="Linux"><code class="language-Linux">yum -y install httpdsystemctl enable httpdsystemctl start httpd<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="配置yum源服务"><a href="#配置yum源服务" class="headerlink" title="配置yum源服务"></a>配置yum源服务</h3><p><strong>①上传ambari、HDP、HDP-UTILS</strong></p><p><strong>②解压ambari、HDP、HDP-UTILS</strong></p><pre class="line-numbers language-linux" data-language="linux"><code class="language-linux">mkdir -p /var/www/html/ambari/HDP-UTILStar -zxvf HDP-UTILS-1.1.0.21-centos7.tar.gz -C /var/www/html/ambari/HDP-UTILS/tar -zxvf HDP-2.6.3.0-centos7-rpm.tar.gz -C /var/www/html/ambari/tar -zxvf ambari-2.6.0.0-centos7.tar.gz -C /var/www/html/ambari/<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>③配置系统yum源</strong></p><p>设置ambari.repo文件</p><pre class="line-numbers language-linux" data-language="linux"><code class="language-linux">vim /etc/yum.repos.d/ambari.repo<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p># 添加如下内容</p><pre class="line-numbers language-sh" data-language="sh"><code class="language-sh">#VERSION_NUMBER=2.6.0.0-267[ambari-2.6.0.0]name=ambari Version - ambari-2.6.0.0baseurl=http://master/ambari/ambari/centos7/2.6.0.0-267gpgcheck=1gpgkey=http://master/ambari/ambari/centos7/2.6.0.0-267/RPM-GPG-KEY/RPM-GPG-KEY-Jenkinsenabled=1priority=1<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>设置hdf.repo文件</p><pre class="line-numbers language-linux" data-language="linux"><code class="language-linux">vim /etc/yum.repos.d/hdp.repo<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p># 添加如下内容</p><pre class="line-numbers language-sh" data-language="sh"><code class="language-sh">#VERSION_NUMBER=2.6.3.0-235[HDP-2.6.3.0]name=HDP Version - HDP-2.6.3.0baseurl=http://master/ambari/HDP/centos7/2.6.3.0-235gpgcheck=1gpgkey=http://master/ambari/HDP/centos7/2.6.3.0-235/RPM-GPG-KEY/RPM-GPG-KEY-Jenkinsenabled=1priority=1[HDP-UTILS-1.1.0.21]name=HDP-UTILS Version - HDP-UTILS-1.1.0.21baseurl=http://master/ambari/HDP-UTILSgpgcheck=1gpgkey=http://master/ambari/HDP-UTILS/RPM-GPG-KEY/RPM-GPG-KEY-Jenkinsenabled=1priority=1<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>④生成离线源</strong></p><pre class="line-numbers language-linux" data-language="linux"><code class="language-linux">createrepo /var/www/html/ambari/ambari/createrepo /var/www/html/ambari/HDPcreaterepo /var/www/html/ambari/HDP-UTILS/<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="http://qypk54f5a.hn-bkt.clouddn.com/d5afdd9f3069f44911dcc6b8bbf97d17.jpg"></p><p><strong>⑤刷新yum源</strong></p><p># 清理yum源缓存</p><pre class="line-numbers language-linux" data-language="linux"><code class="language-linux">yum clean all<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p># 生成yum源缓存</p><pre class="line-numbers language-linux" data-language="linux"><code class="language-linux">yum makecache<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p># 查询有效yum包</p><pre class="line-numbers language-linux" data-language="linux"><code class="language-linux">yum repolist<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="http://qypk54f5a.hn-bkt.clouddn.com/71eea5e22242abe1c26c6b5f775e2472.jpg"></p><h3 id="安装与配置Ambari-Server"><a href="#安装与配置Ambari-Server" class="headerlink" title="安装与配置Ambari-Server"></a>安装与配置Ambari-Server</h3><p><strong>①安装ambari-server</strong></p><pre class="line-numbers language-linux" data-language="linux"><code class="language-linux">yum -y install ambari-server<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><strong>②配置JDBC驱动包</strong></p><pre class="line-numbers language-linux" data-language="linux"><code class="language-linux">mkdir /usr/share/java/<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p># 将jdbc驱动包复制到ambari-server的resource依赖目录下</p><pre class="line-numbers language-linux" data-language="linux"><code class="language-linux">cp /usr/share/java/mysql-connector-java-5.1.32-bin.jar /var/lib/ambari-server/resources/mysql-jdbc-driver.jarr<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p># 设置ambari-server配置文件</p><pre class="line-numbers language-linux" data-language="linux"><code class="language-linux">vim /etc/ambari-server/conf/ambari.properties<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p># 添加如下内容</p><pre class="line-numbers language-sh" data-language="sh"><code class="language-sh">server.startup.web.timeout=120 \# 设置ambari-server web的启动时间最迟120秒server.jdbc.driver.path=/usr/share/java/mysql-connector-java-5.1.32-bin.jar<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p><strong>③配置ambari信息</strong></p><pre class="line-numbers language-linux" data-language="linux"><code class="language-linux">ambari-server setup<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="http://qypk54f5a.hn-bkt.clouddn.com/76fd9010454399d31f9846e881b6b9a3.jpg"></p><p><img src="http://qypk54f5a.hn-bkt.clouddn.com/75c7030d7423ce9d9377ea38fe90f17c.jpg"></p><p><strong>④初始化Ambari数据库</strong></p><pre class="line-numbers language-linux" data-language="linux"><code class="language-linux">mysql -uroot -p<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>Enter password:</p><p>Welcome to the MySQL monitor. Commands end with ; or \g.</p><p>Your MySQL connection id is 2</p><p>Server version: 5.6.47 MySQL Community Server (GPL)</p><p>Copyright (c) 2000, 2020, Oracle and/or its affiliates. All rights reserved.</p><p>Oracle is a registered trademark of Oracle Corporation and/or its</p><p>affiliates. Other names may be trademarks of their respective</p><p>owners.</p><p>Type ‘help;’ or ‘\h’ for help. Type ‘\c’ to clear the current input statement.</p><pre class="line-numbers language-mysql" data-language="mysql"><code class="language-mysql">mysql&gt; use ambari;Database changedmysql&gt; source /var/lib/ambari-server/resources/Ambari-DDL-MySQL-CREATE.sqlQuery OK, 0 rows affected (0.05 sec)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="启动ambaer-server"><a href="#启动ambaer-server" class="headerlink" title="启动ambaer-server"></a>启动ambaer-server</h3><pre class="line-numbers language-linux" data-language="linux"><code class="language-linux">ambari-server start<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="http://qypk54f5a.hn-bkt.clouddn.com/878f72b42070f3b50e329e56ea81e328.jpg"></p><h3 id="五-创建ambari-agent集群"><a href="#五-创建ambari-agent集群" class="headerlink" title="(五)创建ambari-agent集群"></a>(五)创建ambari-agent集群</h3><p>master:8080进入后台管理页：账号/密码admin</p><p><img src="http://qypk54f5a.hn-bkt.clouddn.com/2e8f7e6ffcbc2de8c275e7949fc31165.jpg"></p><p>安装集群</p><p><img src="http://qypk54f5a.hn-bkt.clouddn.com/00de614c0b8617ff670745d8d566dc47.jpg"></p><p>集群名称为：bigdata，点击Next</p><p><img src="http://qypk54f5a.hn-bkt.clouddn.com/3c6c0c523bf43d2527cd520eb4b454f9.jpg"></p><p>删除其他OS，只保留redhat7，并填写HDP、HDP-UTILS仓库地址</p><p><img src="http://qypk54f5a.hn-bkt.clouddn.com/f099b2b51d5739aca664b76b61e7d971.jpg"></p><p>填写需要安装ambari-agent的主机名并上传master主节点的ssh私钥</p><p><img src="http://qypk54f5a.hn-bkt.clouddn.com/2ec54c5996d13c516159589cb188262b.jpg"></p><p>注册ambari-agent</p><p><img src="http://qypk54f5a.hn-bkt.clouddn.com/f903e0a5432ed8ae979b8056dbf0ead3.jpg"></p><p>选择集群需要安装的服务</p><p><img src="http://qypk54f5a.hn-bkt.clouddn.com/0ec250a1d650fb52c62e8605c0cced11.jpg"></p><p>分配每个服务在集群中的位置</p><p><img src="http://qypk54f5a.hn-bkt.clouddn.com/3b8d5d2157de3c127d2a338c6397a661.jpg"></p><p>分配slave和client</p><p><img src="http://qypk54f5a.hn-bkt.clouddn.com/3b8d5d2157de3c127d2a338c6397a661.jpg"></p><p>输入amin管理员密码</p><p><img src="http://qypk54f5a.hn-bkt.clouddn.com/17af063116648eb0f2b85f81f055cd44.jpg"></p><p><img src="http://qypk54f5a.hn-bkt.clouddn.com/6c8faa38c825eb71f26732343437aa5c.jpg"></p><p>安装集群服务</p><p><img src="http://qypk54f5a.hn-bkt.clouddn.com/25e01583de2940173a5ba870d038c489.jpg"></p><p>安装完成后，进入Ambari管理平台首页</p><p><img src="http://qypk54f5a.hn-bkt.clouddn.com/a8f2bb4dc9f4be83c931fb00694bb895.jpg"></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>MySQL5.7的安装</title>
      <link href="/2021/08/31/mysql5-7-de-an-zhuang/"/>
      <url>/2021/08/31/mysql5-7-de-an-zhuang/</url>
      
        <content type="html"><![CDATA[<h1 id="rpm安装mysql5-7"><a href="#rpm安装mysql5-7" class="headerlink" title="rpm安装mysql5.7"></a>rpm安装mysql5.7</h1><p>准备：</p><pre class="line-numbers language-linux" data-language="linux"><code class="language-linux">yum install wget -yyum install yum-utils -y<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><!--已安装就无视--><h3 id="1-centos7自带有mariadb，需要卸载"><a href="#1-centos7自带有mariadb，需要卸载" class="headerlink" title="1.centos7自带有mariadb，需要卸载"></a>1.centos7自带有mariadb，需要卸载</h3><p>执行<code>rpm -qa|grep mariadb</code>查询是否有mariadb的安装包</p><p><img src="https://cdn.jsdelivr.net/gh/tfeng233/blog-imgs/%E7%AC%AC1%E9%A1%B5-2.jpg"></p><p>如有提示，执行<code>rpm -e --nodeps mariadb-libs</code>删除它，没提示可以无视</p><h3 id="2-下载MySQL安装包"><a href="#2-下载MySQL安装包" class="headerlink" title="2.下载MySQL安装包"></a>2.下载MySQL安装包</h3><p>1.前往官方网站复制yum源链接<a href="https://dev.mysql.com/downloads/repo/yum/">MySQL</a></p><p><img src="https://cdn.jsdelivr.net/gh/tfeng233/blog-imgs/%E7%AC%AC1%E9%A1%B5-1.jpg"></p><p><img src="https://cdn.jsdelivr.net/gh/tfeng233/blog-imgs/%E7%AC%AC2%E9%A1%B5-5.jpg"></p><p>2.执行<code>wget rpm -ivh mysql80-community-release-el7-3.noarch.rpm</code>（即你复制的下载链接）进行下载</p><p><img src="https://cdn.jsdelivr.net/gh/tfeng233/blog-imgs/%E7%AC%AC2%E9%A1%B5-4.jpg"></p><h3 id="2-进行yum安装"><a href="#2-进行yum安装" class="headerlink" title="2.进行yum安装"></a>2.进行yum安装</h3><p>执行<code>rpm -ivh mysql80-community-release-el7-3.noarch.rpm</code>命令</p><p><img src="https://cdn.jsdelivr.net/gh/tfeng233/blog-imgs/%E7%AC%AC2%E9%A1%B5-3.jpg"></p><p>接下来可以通过<code>yum repolist all | grep mysql</code>查看yum源中的mysql安装包</p><p><img src="https://cdn.jsdelivr.net/gh/tfeng233/blog-imgs/%E7%AC%AC3%E9%A1%B5-9.jpg"></p><h3 id="3-进行MySQL安装"><a href="#3-进行MySQL安装" class="headerlink" title="3.进行MySQL安装"></a>3.进行MySQL安装</h3><p>可以看到yum源中默认启用的安装包版本为MySQL8.0，如果需要切换为5.7，需要运行以下命令：</p><p><code>yum-config-manager --disable mysql80-community</code></p><p><img src="https://cdn.jsdelivr.net/gh/tfeng233/blog-imgs/%E7%AC%AC3%E9%A1%B5-8.jpg"></p><p><code>yum-config-manager --enable mysql57-community</code></p><p><img src="https://cdn.jsdelivr.net/gh/tfeng233/blog-imgs/%E7%AC%AC3%E9%A1%B5-7.jpg"></p><p>进行安装：</p><p><code>yum install mysql-community-server -y</code></p><p>注意：可能会很慢可以自行到<a href="http://uni.mirrors.163.com/mysql/Downloads/MySQL-5.7/%E4%B8%8B%E8%BD%BD%E7%9B%B8%E5%AF%B9%E5%BA%94%E7%9A%84%E7%89%88%E6%9C%AC">http://uni.mirrors.163.com/mysql/Downloads/MySQL-5.7/下载相对应的版本</a></p><p>目录：</p><pre class="line-numbers language-none"><code class="language-none">/var/cache/yum/x86_64/7/mysql57-community/packages<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="https://cdn.jsdelivr.net/gh/tfeng233/blog-imgs/image-20210916141120008.jpg"></p><p><img src="https://cdn.jsdelivr.net/gh/tfeng233/blog-imgs/%E7%AC%AC3%E9%A1%B5-6.jpg"></p><h3 id="4-启动MySQL服务"><a href="#4-启动MySQL服务" class="headerlink" title="4.启动MySQL服务"></a>4.启动MySQL服务</h3><p>启动mysql服务 <code>systemctl start mysqld.service</code></p><p>查看mysql服务运行状态 <code>systemctl status mysqld.service</code></p><p><img src="https://cdn.jsdelivr.net/gh/tfeng233/blog-imgs/%E7%AC%AC4%E9%A1%B5-12.jpg"></p><p>MySQL服务器初始化（从MySQL 5.7开始）：在服务器初始启动时，如果服务器的数据目录为空，则会发生以下情况：</p><ul><li>服务器已初始化。</li><li>在数据目录中生成SSL证书和密钥文件。</li><li>该<a href="https://dev.mysql.com/doc/refman/8.0/en/validate-password.html">validate_password插件</a>安装并启用。</li><li>默认将<code>'root'@'localhost'</code> 创建一个超级用户帐户。设置超级用户的密码并将其存储在错误日志文件中。要显示它，请使用以下命令：</li></ul><p>查看MySQL root用户默认密码<code>grep 'temporary password' /var/log/mysqld.log</code></p><p><img src="https://cdn.jsdelivr.net/gh/tfeng233/blog-imgs/%E7%AC%AC4%E9%A1%B5-11.jpg"></p><p>通过使用生成的临时密码登录并为超级用户帐户设置自定义密码，尽快更改root密码：</p><p><code>mysql -u root -p</code></p><p>Enter pasword：查询的默认密码（输入密码不会有提示）</p><p><img src="https://cdn.jsdelivr.net/gh/tfeng233/blog-imgs/%E7%AC%AC4%E9%A1%B5-10.jpg"></p><p>注意<br>MySQL的 <a href="https://dev.mysql.com/doc/refman/8.0/en/validate-password.html">validate_password</a> 插件默认安装。</p><p>这将要求密码包含至少一个大写字母，一个小写字母，一个数字和一个特殊字符，并且密码总长度至少为8个字符。</p><p>如果您需要修改简单密码，可以依次执行以下操作步骤:</p><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">set</span> <span class="token keyword">global</span> validate_password_policy<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span><span class="token keyword">set</span> <span class="token keyword">global</span> validate_password_length<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span><span class="token keyword">set</span> <span class="token keyword">global</span> validate_password_mixed_case_count<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">;</span><span class="token comment">-- 然后进行密码更改</span><span class="token keyword">ALTER</span> <span class="token keyword">USER</span> <span class="token string">'root'</span><span class="token variable">@'localhost'</span> IDENTIFIED <span class="token keyword">BY</span> <span class="token string">'你的密码'</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>外部访问MySQL</p><pre class="line-numbers language-mysql" data-language="mysql"><code class="language-mysql">use mysql;--查询正常结果来说，应该都是localhostselect  User,authentication_string,Host from user;--这里可以根据你的情况或者是自己的喜好进行酌情修改GRANT ALL PRIVILEGES ON *.* TO 'root'@'%' IDENTIFIED BY '密码';--清除缓存，重新加载权限flush privileges;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> 数据库 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> MySQL </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Hive安装</title>
      <link href="/2021/08/31/hive-an-zhuang/"/>
      <url>/2021/08/31/hive-an-zhuang/</url>
      
        <content type="html"><![CDATA[<h1 id="hive安装与配置"><a href="#hive安装与配置" class="headerlink" title="hive安装与配置"></a>hive安装与配置</h1><p>查看 IP ：<code>ip add</code>  ，记住ip后面有作用</p><p><img src="https://cdn.jsdelivr.net/gh/Tfeng233/blog-imgs/%E7%AC%AC1%E9%A1%B5-2.PNG"></p><h3 id="一、在hadoop上创建hive所需要的目录"><a href="#一、在hadoop上创建hive所需要的目录" class="headerlink" title="一、在hadoop上创建hive所需要的目录"></a>一、在hadoop上创建hive所需要的目录</h3><p>确保hadoop开启，可通过jps查看</p><p><code>jps</code></p><p><img src="https://cdn.jsdelivr.net/gh/Tfeng233/blog-imgs/%E7%AC%AC1%E9%A1%B5-1.PNG"></p><p>创建文件</p><pre class="line-numbers language-linux" data-language="linux"><code class="language-linux">// 创建文件hadoop fs -mkdir -p /hive/datahadoop fs -mkdir -p /hive/logshadoop fs -mkdir -p /hive/temp//赋予权限hadoop fs -chmod +w /hive/datahadoop fs -chmod +w /hive/logshadoop fs -chmod +w /hive/temp//查看hadoop fs -ls /hive/<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://cdn.jsdelivr.net/gh/Tfeng233/blog-imgs/%E7%AC%AC2%E9%A1%B5-4.PNG"></p><hr><h3 id="二、准备MySQL"><a href="#二、准备MySQL" class="headerlink" title="二、准备MySQL"></a>二、准备MySQL</h3><p>hive需要与MySQL进行连接，保持数据库表的持久化</p><p>1.创建hive数据库(metastore)与hive用户</p><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">create</span> <span class="token keyword">user</span> hive<span class="token variable">@'%'</span> identified <span class="token keyword">by</span> <span class="token string">'密码'</span><span class="token punctuation">;</span><span class="token keyword">create</span> <span class="token keyword">database</span> metastore<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><img src="https://cdn.jsdelivr.net/gh/Tfeng233/blog-imgs/%E7%AC%AC2%E9%A1%B5-3.PNG"></p><p>2.hive用户权限设置</p><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">grant</span> <span class="token keyword">all</span> <span class="token keyword">on</span> <span class="token operator">*</span><span class="token punctuation">.</span><span class="token operator">*</span> <span class="token keyword">to</span> hive<span class="token variable">@'%'</span><span class="token punctuation">;</span><span class="token comment">//全部权限</span>flush <span class="token keyword">privileges</span><span class="token punctuation">;</span><span class="token comment">//刷新</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>3.配置hive与mysql的连接</p><p><img src="https://cdn.jsdelivr.net/gh/Tfeng233/blog-imgs/%E7%AC%AC3%E9%A1%B5-8.PNG"></p><pre class="line-numbers language-linux" data-language="linux"><code class="language-linux">cp mysql-connector-java-8.0.20/mysql-connector-java-8.0.20.jar $HIVE_HOME/lib/ll -h /usr/local/hive-2.3.7/lib/mysql-connector-java-8.0.20.jar<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><img src="https://cdn.jsdelivr.net/gh/Tfeng233/blog-imgs/%E7%AC%AC3%E9%A1%B5-7.PNG"></p><hr><h3 id="三、安装hive"><a href="#三、安装hive" class="headerlink" title="三、安装hive"></a>三、安装hive</h3><p>进入存放hive安装包的目录（我的在/opt下）</p><p><img src="https://cdn.jsdelivr.net/gh/Tfeng233/blog-imgs/%E7%AC%AC3%E9%A1%B5-6.PNG"></p><p>将hive解压</p><p><code>tar -zxvf apache-hive-2.3.7-bin.tar.gz -C /usr/local/</code> -C 是解压到指定位置（/usr/local/）</p><p>进入你的解压位置：<code>cd /usr/loca/</code></p><p><img src="https://cdn.jsdelivr.net/gh/Tfeng233/blog-imgs/%E7%AC%AC3%E9%A1%B5-5.PNG"></p><p>重命名文件：<code>mv apache-hive-2.3.7-bin/ hive-2.3.7</code></p><p><img src="https://cdn.jsdelivr.net/gh/Tfeng233/blog-imgs/%E7%AC%AC4%E9%A1%B5-13.PNG"></p><p>进入hive-2.3.7：<code>cd hive-2.3.7</code>并使用<code>pwd</code>命令获取当前路径</p><p>将hive写进环境变量<code>/etc/profile</code></p><p><code>vim /etc/profile</code></p><pre class="line-numbers language-linux" data-language="linux"><code class="language-linux"># hiveexport HIVE_HOME=/usr/local/hive-2.3.7export PATH=$PATH:$HIVE_HOME/sbin:$HIVE_HOME/bin::$PATH<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p><img src="https://cdn.jsdelivr.net/gh/Tfeng233/blog-imgs/%E7%AC%AC4%E9%A1%B5-11.PNG"></p><p>刷新环境变量：<code>source  /etc/profile</code></p><p>执行<code>hive --version</code> 有版本显示则表示安装成功</p><p><img src="https://cdn.jsdelivr.net/gh/Tfeng233/blog-imgs/%E7%AC%AC4%E9%A1%B5-10.PNG"></p><p>在$HIVE_HOME目录下创建doc、log文件夹</p><p><img src="https://cdn.jsdelivr.net/gh/Tfeng233/blog-imgs/%E7%AC%AC4%E9%A1%B5-9.PNG"></p><hr><h3 id="四、配置文件"><a href="#四、配置文件" class="headerlink" title="四、配置文件"></a>四、配置文件</h3><p>进入hive conf目录：<code>cd $HIVE_HOME/conf</code></p><p><img src="https://cdn.jsdelivr.net/gh/Tfeng233/blog-imgs/%E7%AC%AC5%E9%A1%B5-17.PNG"></p><p>打印hadoop文件位置<code>echo $HADOOP_HOME</code> </p><p><img src="https://cdn.jsdelivr.net/gh/Tfeng233/blog-imgs/%E7%AC%AC5%E9%A1%B5-16.PNG"></p><p><strong>配置hive-env.sh</strong></p><p>以模板复制一份<code>cp hive-env.sh.template hive-env.sh</code></p><p><code>vim hive-env.sh</code></p><p><img src="https://cdn.jsdelivr.net/gh/Tfeng233/blog-imgs/%E7%AC%AC5%E9%A1%B5-15.PNG"></p><pre class="line-numbers language-linux" data-language="linux"><code class="language-linux">HADOOP_HOME=/usr/local/hadoop-2.7.7 //hadoop安装目录<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="https://cdn.jsdelivr.net/gh/Tfeng233/blog-imgs/%E7%AC%AC5%E9%A1%B5-14.PNG"></p><p><strong>配置hive-site.xml</strong></p><p><code>vim hive-site.xml</code></p><pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token prolog">&lt;?xml version="1.0" encoding="UTF-8" standalone="no"?&gt;</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>configuration</span><span class="token punctuation">&gt;</span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>                <span class="token comment">&lt;!--该目录由Hive用来存储查询的不同map / reduce阶段的计划以及存储这些阶段的中间输出 --&gt;</span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>hive.exec.scratchdir<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>/usr/local/hive-2.3.7/doc/tmp<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>                <span class="token comment">&lt;!--本地数据仓库目录--&gt;</span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>hive.metastore.warehouse.dir<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>/usr/local/hive-2.3.7/doc/warehouse<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>                <span class="token comment">&lt;!--hive运行日志位置--&gt;</span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>hive.querylog.location<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>/usr/local/hive-2.3.7/doc/logs<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>                <span class="token comment">&lt;!-- 配置 MySQL 数据库连接信息 --&gt;</span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>javax.jdo.option.ConnectionURL<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>jdbc:mysql://ip地址:3306/metastore<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>javax.jdo.option.ConnectionDriverName<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>com.mysql.cj.jdbc.Driver<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>                <span class="token comment">&lt;!--mysql中HIVE用户--&gt;</span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>javax.jdo.option.ConnectionUserName<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>hive<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>                <span class="token comment">&lt;!--mysql中HIVE密码--&gt;</span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>javax.jdo.option.ConnectionPassword<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>密码<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>configuration</span><span class="token punctuation">&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>hive元数据库初始化</strong></p><p>回到hive的bin目录下</p><p><img src="https://cdn.jsdelivr.net/gh/Tfeng233/blog-imgs/%E7%AC%AC6%E9%A1%B5-19.PNG"></p><pre class="line-numbers language-linux" data-language="linux"><code class="language-linux">schematool -dbType mysql -initSchema //初始化命令<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="https://cdn.jsdelivr.net/gh/Tfeng233/blog-imgs/%E7%AC%AC6%E9%A1%B5-18.PNG"></p><p>测验</p><p><img src="https://cdn.jsdelivr.net/gh/Tfeng233/blog-imgs/%E7%AC%AC7%E9%A1%B5-20.PNG"></p>]]></content>
      
      
      <categories>
          
          <category> 大数据 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Hive </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Hadoop完全分布式搭建</title>
      <link href="/2021/08/31/hadoop-wan-quan-fen-bu-shi-da-jian/"/>
      <url>/2021/08/31/hadoop-wan-quan-fen-bu-shi-da-jian/</url>
      
        <content type="html"><![CDATA[<h2 id="Hadoop的三种模式"><a href="#Hadoop的三种模式" class="headerlink" title="Hadoop的三种模式"></a>Hadoop的三种模式</h2><p>三种模式：本地 、伪分布式、全分布式、高可用HA（重点）</p><blockquote><p>思考：伪分布式模式存在的问题？</p><p>​            模拟集群  实质上在一个节点上面的操作</p><p>全分布式：NN DN  SNN  用多台节点（服务器）来运行的，并没有用高可用HA</p><p>高可用：HA</p></blockquote><h1 id="任务描述"><a href="#任务描述" class="headerlink" title="任务描述"></a>任务描述</h1><p>大数据集群Hadoop全分布式搭建</p><h1 id="任务实现"><a href="#任务实现" class="headerlink" title="任务实现"></a>任务实现</h1><h2 id="全分布式大数据集群规划"><a href="#全分布式大数据集群规划" class="headerlink" title="全分布式大数据集群规划"></a>全分布式大数据集群规划</h2><h3 id="集群拓扑"><a href="#集群拓扑" class="headerlink" title="集群拓扑"></a>集群拓扑</h3><p><img src="https://cdn.jsdelivr.net/gh/Tfeng233/blog-imgs/1589953548482.png" alt="1589953548482"></p><h3 id="主机-角色-规划"><a href="#主机-角色-规划" class="headerlink" title="主机(角色)规划"></a>主机(角色)规划</h3><table><thead><tr><th><strong>节点名称</strong></th><th>IP</th><th><strong>namenode</strong></th><th><strong>datanode</strong></th><th><strong>SecondaryNameNode</strong></th></tr></thead><tbody><tr><td>node01</td><td>192.168.32.2</td><td>*</td><td>*</td><td></td></tr><tr><td>node02</td><td>192.168.32.3</td><td></td><td>*</td><td>*</td></tr><tr><td>node03</td><td>192.168.32.4</td><td></td><td>*</td><td></td></tr></tbody></table><p>准备三个虚拟机,三个虚拟机分别设置好对应的网络ip配置</p><h3 id="软件规划"><a href="#软件规划" class="headerlink" title="软件规划"></a>软件规划</h3><table><thead><tr><th>软件</th><th>版本</th><th>安装节点</th><th>说明</th></tr></thead><tbody><tr><td>VMWARE</td><td></td><td></td><td></td></tr><tr><td>CentOS</td><td>7</td><td>*</td><td>Linux操作系统</td></tr><tr><td>JDK</td><td>1.8</td><td>*</td><td>Hadoop基于Java，所以必须提前安装JDK</td></tr><tr><td>Hadoop</td><td>2.7.7</td><td>*</td><td>运行处理大数据的软件平台</td></tr></tbody></table><h3 id="软件目录规划"><a href="#软件目录规划" class="headerlink" title="软件目录规划"></a>软件目录规划</h3><table><thead><tr><th>目录名称</th><th>绝对路径</th></tr></thead><tbody><tr><td>所有软件包存放目录</td><td>/usr/tools</td></tr><tr><td>大数据软件安装目录</td><td>/usr/local/*</td></tr></tbody></table><h2 id="虚拟机安装"><a href="#虚拟机安装" class="headerlink" title="虚拟机安装"></a>虚拟机安装</h2><p><img src="_posts/https://cdn.jsdelivr.net/gh/Tfeng233/blog-imgs/1589955109191.png" alt="1589955109191"></p><p><img src="https://cdn.jsdelivr.net/gh/Tfeng233/blog-imgs/1589955120259.png" alt="1589955120259"></p><p><img src="https://cdn.jsdelivr.net/gh/Tfeng233/blog-imgs/1589955167199.png" alt="1589955167199"></p><p><img src="https://cdn.jsdelivr.net/gh/Tfeng233/blog-imgs/1589955183882.png" alt="1589955183882"></p><p><img src="https://cdn.jsdelivr.net/gh/Tfeng233/blog-imgs/1589955200679.png" alt="1589955200679"></p><p><img src="https://cdn.jsdelivr.net/gh/Tfeng233/blog-imgs/1589955210138.png" alt="1589955210138"></p><p><img src="https://cdn.jsdelivr.net/gh/Tfeng233/blog-imgs/1589955216696.png" alt="1589955216696"></p><p><img src="https://cdn.jsdelivr.net/gh/Tfeng233/blog-imgs/1589955222045.png" alt="1589955222045"></p><p><img src="https://cdn.jsdelivr.net/gh/Tfeng233/blog-imgs/1589955232869.png" alt="1589955232869"></p><p><img src="https://cdn.jsdelivr.net/gh/Tfeng233/blog-imgs/1589955239722.png" alt="1589955239722"></p><p><img src="https://cdn.jsdelivr.net/gh/Tfeng233/blog-imgs/1589955252135.png" alt="1589955252135"></p><p><img src="https://cdn.jsdelivr.net/gh/Tfeng233/blog-imgs/1589955258196.png" alt="1589955258196"></p><p><img src="https://cdn.jsdelivr.net/gh/Tfeng233/blog-imgs/1589955262315.png" alt="1589955262315"></p><p><img src="https://cdn.jsdelivr.net/gh/Tfeng233/blog-imgs/1589955266780.png" alt="1589955266780"></p><p><img src="https://cdn.jsdelivr.net/gh/Tfeng233/blog-imgs/1589955273074.png" alt="1589955273074">Linux操作系统安装</p><p><img src="https://cdn.jsdelivr.net/gh/Tfeng233/blog-imgs/1589955299950.png" alt="1589955299950"></p><p><img src="https://cdn.jsdelivr.net/gh/Tfeng233/blog-imgs/1589955308231.png" alt="1589955308231"></p><p><img src="https://cdn.jsdelivr.net/gh/Tfeng233/blog-imgs/1589955316201.png" alt="1589955316201"></p><p><img src="https://cdn.jsdelivr.net/gh/Tfeng233/blog-imgs/1589955327495.png" alt="1589955327495"></p><p><img src="https://cdn.jsdelivr.net/gh/Tfeng233/blog-imgs/1589955332876.png" alt="1589955332876"></p><p><img src="https://cdn.jsdelivr.net/gh/Tfeng233/blog-imgs/1589955340503.png" alt="1589955340503"></p><p><img src="https://cdn.jsdelivr.net/gh/Tfeng233/blog-imgs/1589955383743.png" alt="1589955383743"></p><p><img src="https://cdn.jsdelivr.net/gh/Tfeng233/blog-imgs/1589955398635.png" alt="1589955398635"></p><p><img src="https://cdn.jsdelivr.net/gh/Tfeng233/blog-imgs/1589955404694.png" alt="1589955404694"></p><p><img src="https://cdn.jsdelivr.net/gh/Tfeng233/blog-imgs/1589955412625.png" alt="1589955412625"></p><p><img src="https://cdn.jsdelivr.net/gh/Tfeng233/blog-imgs/1589955421739.png" alt="1589955421739"></p><p><img src="https://cdn.jsdelivr.net/gh/Tfeng233/blog-imgs/1589955430856.png" alt="1589955430856"></p><p><img src="https://cdn.jsdelivr.net/gh/Tfeng233/blog-imgs/1589955436104.png" alt="1589955436104"></p><p><img src="https://cdn.jsdelivr.net/gh/Tfeng233/blog-imgs/1589955441918.png" alt="1589955441918"></p><h2 id="虚拟机拍照"><a href="#虚拟机拍照" class="headerlink" title="虚拟机拍照"></a>虚拟机拍照</h2><ol><li>关闭虚拟机</li><li>拍照</li></ol><h2 id="虚拟机网络适配器设置"><a href="#虚拟机网络适配器设置" class="headerlink" title="虚拟机网络适配器设置"></a>虚拟机网络适配器设置</h2><h3 id="选择联网模式"><a href="#选择联网模式" class="headerlink" title="选择联网模式"></a>选择联网模式</h3><ol><li><p>桥接模式</p><p><img src="https://cdn.jsdelivr.net/gh/Tfeng233/blog-imgs/1589957562935.png" alt="1589957562935"></p></li><li><p>Nat模式</p><p><img src="https://cdn.jsdelivr.net/gh/Tfeng233/blog-imgs/1589957906167.png" alt="1589957906167"></p></li><li><p>仅主机模式</p><p><img src="https://cdn.jsdelivr.net/gh/Tfeng233/blog-imgs/1589957938149.png" alt="1589957938149"></p></li></ol><p><img src="https://cdn.jsdelivr.net/gh/Tfeng233/blog-imgs/1589958403997.png" alt="1589958403997"></p><p><img src="https://cdn.jsdelivr.net/gh/Tfeng233/blog-imgs/1589958441728.png" alt="1589958441728"></p><p><img src="https://cdn.jsdelivr.net/gh/Tfeng233/blog-imgs/1589958503178.png" alt="1589958503178"></p><h3 id="编辑虚拟网络"><a href="#编辑虚拟网络" class="headerlink" title="编辑虚拟网络"></a>编辑虚拟网络</h3><p><img src="https://cdn.jsdelivr.net/gh/Tfeng233/blog-imgs/1589958814217.png" alt="1589958814217"></p><p><img src="https://cdn.jsdelivr.net/gh/Tfeng233/blog-imgs/1589958802571.png" alt="1589958802571">配置IP地址</p><p><img src="https://cdn.jsdelivr.net/gh/Tfeng233/blog-imgs/1589959839006.png" alt="1589959839006"></p><pre class="line-numbers language-sh" data-language="sh"><code class="language-sh">#修改BOOTPROTO=static #这里讲dhcp换成staticONBOOT=yes #将no换成yes#新增IPADDR=192.168.52.101 #静态IPGATEWAY=192.168.52.2 #默认网关NETMASK=255.255.255.0 #子网掩码DNS1=114.114.114.114 #DNS<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://cdn.jsdelivr.net/gh/Tfeng233/blog-imgs/1589962380018.png" alt="1589962380018"></p><pre class="line-numbers language-sh" data-language="sh"><code class="language-sh">#重启网卡service network restartifconfig 或 ip addr<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://cdn.jsdelivr.net/gh/Tfeng233/blog-imgs/1589960037089.png" alt="1589960037089">MobaXterm连接</p><p><img src="https://cdn.jsdelivr.net/gh/Tfeng233/blog-imgs/1589961334828.png" alt="1589961334828"></p><p><img src="https://cdn.jsdelivr.net/gh/Tfeng233/blog-imgs/1589962468160.png" alt="1589962468160"></p><h3 id="Linux安全机制"><a href="#Linux安全机制" class="headerlink" title="Linux安全机制"></a>Linux安全机制</h3><ol><li><p>关闭防火墙</p></li><li><p>关闭防火墙开机启动</p></li><li><p>修改SELinux配置文件</p><pre class="line-numbers language-sh" data-language="sh"><code class="language-sh">[root@master ~]# systemctl status firewalld.service[root@master ~]# systemctl stop firewalld.service[root@master ~]# systemctl disable firewalld.service[root@master ~]# vi /etc/selinux/config<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre></li></ol><p><img src="https://cdn.jsdelivr.net/gh/Tfeng233/blog-imgs/image-20210305084355647.png" alt="image-20210305084355647"></p><h2 id="安装JDK"><a href="#安装JDK" class="headerlink" title="安装JDK"></a>安装JDK</h2><ol><li><p>创建一个存放软件的目录 </p><pre class="line-numbers language-sh" data-language="sh"><code class="language-sh">[root@localhost ~]# mkdir /usr/tools[root@localhost ~]# cd /usr/tools/[root@localhost tools]# pwd<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p><img src="https://cdn.jsdelivr.net/gh/Tfeng233/blog-imgs/image-20210305084553096.png" alt="image-20210305084553096"></p></li><li><p>上传jdk压缩包到/usr/tools目录下</p><p><img src="https://cdn.jsdelivr.net/gh/Tfeng233/blog-imgs/image-20210305084748788.png" alt="image-20210305084748788"></p></li><li><p>解压</p><pre class="line-numbers language-sh" data-language="sh"><code class="language-sh">[root@localhost tools]# tar -zxvf jdk-8u221-linux-x64.tar.gz  -C /usr/local/<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li><li><p>设置环境变量</p><p><img src="https://cdn.jsdelivr.net/gh/Tfeng233/blog-imgs/1590042543484.png" alt="1590042543484"></p><p>将如下配置添加至文件/etc/profile中，然后保存退出。</p><pre class="line-numbers language-sh" data-language="sh"><code class="language-sh">#javaexport JAVA_HOME=/usr/local/jdk1.8.0_221export CLASSPATH=.:$JAVA_HOME/lib/dt.jar:$JAVA_HOME/libexport PATH=$JAVA_HOME/bin:$PATH<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://cdn.jsdelivr.net/gh/Tfeng233/blog-imgs/image-20210305141301802.png" alt="image-20210305141301802"></p></li><li><p>让配置文件生效</p><pre class="line-numbers language-sh" data-language="sh"><code class="language-sh">[root@node01 java]# source /etc/profile<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li><li><p>验证</p><pre class="line-numbers language-sh" data-language="sh"><code class="language-sh">[root@node01 java]# java -version<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li></ol><p><img src="https://cdn.jsdelivr.net/gh/Tfeng233/blog-imgs/image-20210305085208531.png" alt="image-20210305085208531"></p><h2 id="再次拍照"><a href="#再次拍照" class="headerlink" title="再次拍照"></a>再次拍照</h2><ol><li>关机</li><li>拍照</li></ol><h2 id="集群复制"><a href="#集群复制" class="headerlink" title="集群复制"></a>集群复制</h2><h3 id="克隆节点"><a href="#克隆节点" class="headerlink" title="克隆节点"></a>克隆节点</h3><p><img src="https://cdn.jsdelivr.net/gh/Tfeng233/blog-imgs/1590020909682.png" alt="1590020909682"></p><p><img src="https://cdn.jsdelivr.net/gh/Tfeng233/blog-imgs/1590020936092.png" alt="1590020936092"></p><p><img src="https://cdn.jsdelivr.net/gh/Tfeng233/blog-imgs/1590021035956.png" alt="1590021035956"></p><p>再重复此操作创建出Node02 node03</p><p><img src="https://cdn.jsdelivr.net/gh/Tfeng233/blog-imgs/1590021155731.png" alt="1590021155731"></p><h3 id="配置IP"><a href="#配置IP" class="headerlink" title="配置IP"></a>配置IP</h3><p><img src="https://cdn.jsdelivr.net/gh/Tfeng233/blog-imgs/1590021695079.png" alt="1590021695079"></p><p><img src="https://cdn.jsdelivr.net/gh/Tfeng233/blog-imgs/1590021665832.png" alt="1590021665832"></p><p><img src="https://cdn.jsdelivr.net/gh/Tfeng233/blog-imgs/1590021802827.png" alt="1590021802827"></p><p>其它2台对应修改</p><p><img src="https://cdn.jsdelivr.net/gh/Tfeng233/blog-imgs/1590021970210.png" alt="1590021970210"></p><p><img src="https://cdn.jsdelivr.net/gh/Tfeng233/blog-imgs/1590021983803.png" alt="1590021983803"></p><h3 id="修改主机名"><a href="#修改主机名" class="headerlink" title="修改主机名"></a>修改主机名</h3><p>MobaXterm连上4台机器,修改主机名</p><p><img src="https://cdn.jsdelivr.net/gh/Tfeng233/blog-imgs/1590022368029.png" alt="1590022368029"></p><pre class="line-numbers language-sh" data-language="sh"><code class="language-sh">hostnamectl set-hostname node01<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-sh" data-language="sh"><code class="language-sh">hostnamectl set-hostname node02<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-sh" data-language="sh"><code class="language-sh">hostnamectl set-hostname node03<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="https://cdn.jsdelivr.net/gh/Tfeng233/blog-imgs/1590022542697.png" alt="1590022542697"></p><p><img src="https://cdn.jsdelivr.net/gh/Tfeng233/blog-imgs/1590022588900.png" alt="1590022588900"></p><h3 id="关机创建拍照"><a href="#关机创建拍照" class="headerlink" title="关机创建拍照"></a>关机创建拍照</h3><p><img src="https://cdn.jsdelivr.net/gh/Tfeng233/blog-imgs/1590022896823.png" alt="1590022896823"></p><h2 id="Hadoop安装配置"><a href="#Hadoop安装配置" class="headerlink" title="Hadoop安装配置"></a>Hadoop安装配置</h2><h3 id="虚拟机IP映射"><a href="#虚拟机IP映射" class="headerlink" title="虚拟机IP映射"></a>虚拟机IP映射</h3><p>在node01上编辑 /etc/hosts，加入如下内容</p><pre class="line-numbers language-sh" data-language="sh"><code class="language-sh">192.168.52.101 node01192.168.52.102 node02192.168.52.103 node03<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="SSH免密登录"><a href="#SSH免密登录" class="headerlink" title="SSH免密登录"></a>SSH免密登录</h3><h4 id="所有机器依次执行"><a href="#所有机器依次执行" class="headerlink" title="所有机器依次执行"></a>所有机器依次执行</h4><p>执行过程中需要输入密码，就输入对应密码即可。</p><pre class="line-numbers language-sh" data-language="sh"><code class="language-sh">ssh 127.0.0.1<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="https://cdn.jsdelivr.net/gh/Tfeng233/blog-imgs/wps9.jpg" alt="img"></p><h4 id="在Node01创建秘钥"><a href="#在Node01创建秘钥" class="headerlink" title="在Node01创建秘钥"></a>在Node01创建秘钥</h4><p>下面的命令一行一行的运行，运行过程中如果要输入密码，输入即可。</p><pre class="line-numbers language-sh" data-language="sh"><code class="language-sh">ssh-keygen -t rsa -P '' -f ~/.ssh/id_rsacat ~/.ssh/id_rsa.pub &gt;&gt; ~/.ssh/authorized_keyschmod 0600 ~/.ssh/authorized_keys<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="https://cdn.jsdelivr.net/gh/Tfeng233/blog-imgs/wps10.jpg" alt="img"></p><h4 id="共享公钥"><a href="#共享公钥" class="headerlink" title="共享公钥"></a>共享公钥</h4><p>在node01将公钥推给另外节点，执行：</p><p>可能要输入密码，输入即可</p><pre class="line-numbers language-sh" data-language="sh"><code class="language-sh">[root@node01 ~]# ssh-copy-id -i node01[root@node01 ~]# ssh-copy-id -i node02[root@node01 ~]# ssh-copy-id -i node03<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h4 id="验证"><a href="#验证" class="headerlink" title="验证"></a>验证</h4><p>连的过程中有可能第一次需要输入密码，第二次再去ssh还是需要输入密码就有问题，</p><p>注意事项：一旦ssh连进去了之后一定要退出来，exit</p><pre class="line-numbers language-sh" data-language="sh"><code class="language-sh">ssh node02exit<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-sh" data-language="sh"><code class="language-sh">ssh node03exit<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-sh" data-language="sh"><code class="language-sh">ssh node04exit<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="共享hosts文件"><a href="#共享hosts文件" class="headerlink" title="共享hosts文件"></a>共享hosts文件</h3><p>把hosts文件分发给node02 node03 </p><pre class="line-numbers language-sh" data-language="sh"><code class="language-sh">[root@node01 ~]# scp /etc/hosts root@node02:/etc/[root@node01 ~]# scp /etc/hosts root@node03:/etc/<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="node01（主）安装Hadoop"><a href="#node01（主）安装Hadoop" class="headerlink" title="node01（主）安装Hadoop"></a>node01（主）安装Hadoop</h3><ol><li><p>上传</p><p><img src="https://cdn.jsdelivr.net/gh/Tfeng233/blog-imgs/1590044622284.png" alt="1590044622284"></p></li><li><p>解压</p><pre class="line-numbers language-sh" data-language="sh"><code class="language-sh">[root@node01 ~]# cd /usr/tools/[root@node01 local]# tar -zxvf hadoop-2.7.7.tar.gz -C /usr/local[root@node01 hadoop-2.7.7]# cd /usr/local/hadoop-2.7.7/share/[root@node01 share]# lsdoc  hadoop[root@node01 share]# rm -rf doc<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li><li><p>设置环境变量</p><pre class="line-numbers language-sh" data-language="sh"><code class="language-sh">vi /etc/profile<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>添加如下内容</p><pre class="line-numbers language-none"><code class="language-none"># Hadoopexport HADOOP_HOME=/usr/local/hadoop-2.7.7export PATH=$HADOOP_HOME/bin:$HADOOP_HOME/sbin:$PATH<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li><li><p>环境变量生效</p><pre class="line-numbers language-sh" data-language="sh"><code class="language-sh">[root@node01 ~]# source /etc/profile<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li><li><p>测试验证</p><pre class="line-numbers language-sh" data-language="sh"><code class="language-sh">[root@node01 ~]# hadoop<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li><li><p>分发环境变量</p></li></ol><pre class="line-numbers language-sh" data-language="sh"><code class="language-sh">[root@node01 soft]# scp /etc/profile root@node02:/etc/[root@node01 soft]# scp /etc/profile root@node03:/etc/注意：记得到所有节点上执行source命令<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="配置Hadoop全分布式"><a href="#配置Hadoop全分布式" class="headerlink" title="配置Hadoop全分布式"></a>配置Hadoop全分布式</h3><h4 id="修改hadoop-env-sh"><a href="#修改hadoop-env-sh" class="headerlink" title="修改hadoop-env.sh"></a>修改hadoop-env.sh</h4><p><img src="https://cdn.jsdelivr.net/gh/Tfeng233/blog-imgs/image-20210305161336177.png" alt="image-20210305161336177"></p><pre class="line-numbers language-xml" data-language="xml"><code class="language-xml">export JAVA_HOME=/usr/local/jdk1.8.0_221<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="https://cdn.jsdelivr.net/gh/Tfeng233/blog-imgs/image-20210305160713081.png" alt="image-20210305160713081"></p><h4 id="修改core-site-xml"><a href="#修改core-site-xml" class="headerlink" title="修改core-site.xml"></a>修改core-site.xml</h4><p><img src="https://cdn.jsdelivr.net/gh/Tfeng233/blog-imgs/image-20210305161357980.png" alt="image-20210305161357980"></p><pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>configuration</span><span class="token punctuation">&gt;</span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>fs.defaultFS<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>hdfs://node01:9000<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>hadoop.tmp.dir<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>/var/root/hadoop/full<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>configuration</span><span class="token punctuation">&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>说明：</p><ul><li><p>fs.defaultFS 文件系统对外提供的URI地址以供数据交互。</p></li><li><p>hadoop.tmp.dir是hadoop文件系统依赖的基础配置，很多路径都依赖它。如果hdfs-site.xml中不配置namenode 和datanode的存放位置，默认就放在这个路径下。</p></li></ul><p><img src="https://cdn.jsdelivr.net/gh/Tfeng233/blog-imgs/image-20210305161052241.png" alt="image-20210305161052241"></p><h4 id="修改hdfs-site-xml"><a href="#修改hdfs-site-xml" class="headerlink" title="修改hdfs-site.xml"></a>修改hdfs-site.xml</h4><p><img src="https://cdn.jsdelivr.net/gh/Tfeng233/blog-imgs/image-20210305161422709.png" alt="image-20210305161422709"></p><pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>configuration</span><span class="token punctuation">&gt;</span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>dfs.replication<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>2<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>dfs.namenode.secondary.http-address<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>node02:50090<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>configuration</span><span class="token punctuation">&gt;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>说明：</p><ul><li>dfs.replication  副本数量</li><li>dfs.namenode.secondary.http-address  提供secondary namenode的节点和端口</li></ul><p><img src="https://cdn.jsdelivr.net/gh/Tfeng233/blog-imgs/image-20210305161205537.png" alt="image-20210305161205537"></p><h4 id="修改slaves"><a href="#修改slaves" class="headerlink" title="修改slaves"></a>修改slaves</h4><p><img src="https://cdn.jsdelivr.net/gh/Tfeng233/blog-imgs/image-20210305161434494.png" alt="image-20210305161434494"></p><pre class="line-numbers language-none"><code class="language-none">node01node02node03<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="https://cdn.jsdelivr.net/gh/Tfeng233/blog-imgs/image-20210305161256592.png" alt="image-20210305161256592"></p><h4 id="修改yarn-site-xml"><a href="#修改yarn-site-xml" class="headerlink" title="修改yarn-site.xml"></a>修改yarn-site.xml</h4><p><img src="https://cdn.jsdelivr.net/gh/Tfeng233/blog-imgs/image-20210305161538239.png" alt="image-20210305161538239"></p><p><img src="https://cdn.jsdelivr.net/gh/Tfeng233/blog-imgs/image-20210305161521741.png" alt="image-20210305161521741"></p><pre class="line-numbers language-sh" data-language="sh"><code class="language-sh">&lt;configuration&gt;    &lt;property&gt;        &lt;name&gt;yarn.resourcemanager.hostname&lt;/name&gt;        &lt;value&gt;node01&lt;/value&gt;    &lt;/property&gt;    &lt;property&gt;        &lt;name&gt;yarn.nodemanager.aux-services&lt;/name&gt;        &lt;value&gt;mapreduce_shuffle&lt;/value&gt;    &lt;/property&gt;&lt;/configuration&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h4 id="分发hadoop到各节点"><a href="#分发hadoop到各节点" class="headerlink" title="分发hadoop到各节点"></a>分发hadoop到各节点</h4><pre class="line-numbers language-none"><code class="language-none">[root@node01 hadoop]# scp -r /usr/local/hadoop-2.7.7 root@node02:/usr/local[root@node01 hadoop]# scp -r /usr/local/hadoop-2.7.7 root@node03:/usr/local<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h4 id="格式化和启动"><a href="#格式化和启动" class="headerlink" title="格式化和启动"></a>格式化和启动</h4><ol><li><p>在Node01节点格式化操作</p><pre class="line-numbers language-sh" data-language="sh"><code class="language-sh">[root@node01 ~]# hdfs namenode -format<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li><li><p>启动(只需要在主节点上启动，其他的不需要启动)</p><pre class="line-numbers language-sh" data-language="sh"><code class="language-sh">[root@node01 ~]# start-dfs.sh<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li><li><p>验证</p><pre class="line-numbers language-sh" data-language="sh"><code class="language-sh">[root@node01 ~]# jps7825 NameNode7865 DataNode8060 Jps[root@node02 local]# jps8737 Jps8603 DataNode8671 SecondaryNameNode[root@node03 ~]# jps8439 Jps8364 DataNode<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li><li><p>登陆web地址（<a href="http://192.168.52.101:50070/%EF%BC%89%E6%A3%80%E6%B5%8B">http://192.168.52.101:50070/）检测</a></p></li></ol><h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><p>Hadoop的全分布式搭建的过程：</p><ul><li><p>准备3台虚拟机</p></li><li><p>保证虚拟机网络、IP、主机名、防火墙</p></li><li><p>安装JDK </p></li><li><p>做etc  hosts文件设置</p></li><li><p>免秘钥登陆</p></li><li><p>安装Hadoop</p></li><li><p>上传包 解压</p></li><li><p>配置环境变量</p></li><li><p>让环境变量生效  验证</p></li><li><p>hadoop-env.xml   配置JAVA_HOME</p></li><li><p>core-site.xml  namenode</p></li><li><p>hdfs-site.xml</p></li><li><p>slaves  从节点</p></li><li><p>yarn-site.xml</p></li><li><p>分发Hadoop</p></li><li><p>格式化 hadoop  namenode  -format</p></li><li><p>启动  start-dfs.sh   stop-dfs.sh</p></li><li><p>检查 JPS</p></li></ul>]]></content>
      
      
      <categories>
          
          <category> 大数据 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Hadoop </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
